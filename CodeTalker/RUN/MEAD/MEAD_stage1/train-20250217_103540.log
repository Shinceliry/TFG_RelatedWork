10
Mon Feb 17 10:35:40 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.54.03              Driver Version: 535.54.03    CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA RTX A6000               On  | 00000000:01:00.0 Off |                  Off |
| 30%   25C    P8              28W / 300W |     12MiB / 49140MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA RTX A6000               On  | 00000000:25:00.0 Off |                  Off |
| 30%   37C    P2             191W / 300W |  19810MiB / 49140MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA RTX A6000               On  | 00000000:41:00.0 Off |                  Off |
| 30%   39C    P2             197W / 300W |  31996MiB / 49140MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA RTX A6000               On  | 00000000:61:00.0 Off |                  Off |
| 30%   52C    P2             194W / 300W |  29718MiB / 49140MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA RTX A6000               On  | 00000000:81:00.0 Off |                  Off |
| 59%   82C    P2             294W / 300W |  35546MiB / 49140MiB |     99%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA RTX A6000               On  | 00000000:A1:00.0 Off |                  Off |
| 46%   74C    P2             292W / 300W |  45202MiB / 49140MiB |     98%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA RTX A6000               On  | 00000000:C1:00.0 Off |                  Off |
|100%   91C    P2             263W / 300W |  46680MiB / 49140MiB |     99%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA RTX A6000               On  | 00000000:E1:00.0 Off |                  Off |
| 99%   91C    P2             285W / 300W |  42560MiB / 49140MiB |     98%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+
/home/sakaya/.local/bin/pip
[2025-02-17 10:35:44,840 INFO train_pred.py line 73 474]=>INaffine: False
StepLR: True
adaptive_lr: False
arch: stage1_MEAD
base_lr: 0.0001
batch_size: 1
batch_size_val: 1
data_root: ./MEAD/
dataset: MEAD
dist_backend: nccl
dist_url: tcp://127.0.0.1:6701
distributed: False
epochs: 200
eval_freq: 10
evaluate: True
face_quan_num: 16
factor: 0.3
gamma: 0.5
gpu: 0
hidden_size: 1024
in_dim: 15069
intermediate_size: 1536
manual_seed: 131
model_path: None
momentum: 0.9
multiprocessing_distributed: False
n_embed: 256
neg: 0.2
ngpus_per_node: 1
num_attention_heads: 8
num_hidden_layers: 6
patience: 3
poly_lr: False
power: 0.9
print_freq: 10
quant_factor: 0
quant_loss_weight: 1.0
rank: 0
read_audio: False
resume: None
save: True
save_folder: None
save_freq: 1
save_path: RUN/MEAD/MEAD_stage1
start_epoch: 0
step_size: 20
sync_bn: False
template_file: FLAME2020_generic_model.pkl
test_batch_size: 1
test_gpu: [0]
test_subjects: M013 M042 W026 W040
test_workers: 0
threshold: 0.0001
train_gpu: 0
train_subjects: M003 M005 M007 M009 M012 M019 M039 M041 W009 W011 W014 W015 W021 W023 W024 W028 W029 W033 W035 W036 W037
use_sgd: False
val_subjects: M011 M040 W025 W038
vertices_path: vertices_npy
warmup_steps: 1
wav_path: wav
weight: None
weight_decay: 0.002
window_size: 1
workers: 10
world_size: 1
zquant_dim: 64
[2025-02-17 10:35:44,840 INFO train_pred.py line 74 474]=>=> creating model ...
Loading data...
  0%|          | 0/19101 [00:00<?, ?it/s]  0%|          | 0/19101 [00:00<?, ?it/s]
{'f': array([[   3,    1,    0],
       [   7,    5,    4],
       [  12,   14,   13],
       ...,
       [4492, 4645, 4632],
       [4488, 4632, 4619],
       [4619, 4606, 4480]], dtype=uint32), 'J_regressor': <5x5023 sparse matrix of type '<class 'numpy.float64'>'
	with 43 stored elements in Compressed Sparse Column format>, 'kintree_table': array([[4294967295,          0,          1,          1,          1],
       [         0,          1,          2,          3,          4]]), 'J': array([[-1.33312728e-03, -1.47893615e-01, -8.29415748e-02],
       [ 8.60188480e-05, -8.03977393e-03, -5.49571415e-02],
       [-5.00583446e-04, -1.46254794e-02, -5.92899438e-02],
       [ 3.17244716e-02,  2.13966651e-02,  2.46247328e-02],
       [-3.14523594e-02,  2.14913357e-02,  2.35464192e-02]]), 'bs_style': 'lbs', 'weights': array([[6.38187118e-03, 9.81628184e-01, 1.19893116e-02, 6.33022883e-07,
        0.00000000e+00],
       [6.39955577e-03, 9.77629791e-01, 1.59700159e-02, 6.36988012e-07,
        0.00000000e+00],
       [1.28217407e-04, 9.83802148e-01, 1.60690120e-02, 6.22554030e-07,
        0.00000000e+00],
       ...,
       [0.00000000e+00, 1.17821899e-07, 1.76066056e-07, 1.37504376e-07,
        9.99999569e-01],
       [0.00000000e+00, 1.15945991e-07, 1.81905294e-07, 1.34532952e-07,
        9.99999568e-01],
       [0.00000000e+00, 1.14985715e-07, 1.85878198e-07, 1.32647723e-07,
        9.99999566e-01]]), 'posedirs': array([[[ 8.94585449e-05, -7.12649671e-05, -6.30441624e-05, ...,
         -1.55709882e-09, -1.58154239e-09, -1.37079084e-10],
        [ 5.59484618e-04,  4.91894774e-05,  1.57206106e-04, ...,
          6.75293003e-09,  7.22248598e-09,  2.98410726e-10],
        [-2.83509070e-04,  8.52168488e-05, -2.78280026e-04, ...,
         -5.00922641e-09,  1.19799299e-09, -2.67869136e-10]],

       [[ 8.09151587e-05, -6.68538051e-05, -6.52311895e-05, ...,
         -1.39839163e-09, -2.15903361e-09, -1.33813676e-10],
        [ 5.40434202e-04,  4.86957422e-05,  1.45189349e-04, ...,
          6.46133447e-09,  6.85861039e-09,  2.68799907e-10],
        [-2.79423840e-04,  8.60186448e-05, -2.80253935e-04, ...,
         -5.51575569e-09,  9.79393282e-10, -2.79547564e-10]],

       [[ 1.34015708e-04, -6.95148786e-05, -7.21466218e-05, ...,
         -1.66005819e-09, -1.46997184e-09, -1.35485622e-10],
        [ 5.32419432e-04,  6.35204440e-05,  1.53300177e-04, ...,
          6.70665942e-09,  6.77553305e-09,  2.89176959e-10],
        [-2.82622431e-04,  9.57394342e-05, -1.97691636e-04, ...,
         -5.76969248e-09,  1.55988254e-09, -2.66677955e-10]],

       ...,

       [[ 7.33655261e-09,  6.62574152e-09,  3.61458252e-08, ...,
          8.07073588e-10, -4.91201740e-10,  1.23898723e-10],
        [ 1.15216907e-07, -1.89156205e-08,  5.71462743e-08, ...,
          7.38392275e-11,  2.48537953e-09, -1.99352782e-10],
        [-5.44235100e-08,  1.10644638e-08, -1.10145224e-08, ...,
         -6.17665983e-09,  8.86759355e-09,  8.89446575e-11]],

       [[ 7.28016398e-09,  6.79837421e-09,  3.58955426e-08, ...,
          3.87802791e-10, -3.86536042e-10,  9.33907875e-11],
        [ 1.14704028e-07, -1.84940977e-08,  5.68590844e-08, ...,
          2.52849586e-10,  2.27123771e-09, -1.83006931e-10],
        [-5.47250884e-08,  1.11201273e-08, -1.09076253e-08, ...,
         -5.89595828e-09,  8.60422139e-09,  1.09290941e-10]],

       [[ 7.11649927e-09,  7.08179360e-09,  3.56895091e-08, ...,
          3.58485804e-11, -3.35098976e-10,  6.70754371e-11],
        [ 1.14319555e-07, -1.82411002e-08,  5.66611489e-08, ...,
          4.29868680e-10,  2.07541093e-09, -1.68147661e-10],
        [-5.51649513e-08,  1.12461410e-08, -1.10124530e-08, ...,
         -5.69975421e-09,  8.35410931e-09,  1.24831752e-10]]]), 'v_template': array([[ 0.06347525, -0.00908882, -0.05058782],
       [ 0.0670266 , -0.01007957, -0.04930288],
       [ 0.06757287, -0.0086245 , -0.04892645],
       ...,
       [-0.03827737,  0.02013031,  0.01293258],
       [-0.03615456,  0.020553  ,  0.01177235],
       [-0.03384952,  0.02101186,  0.01105893]]), 'shapedirs': <chumpy.ch.Ch object at 0x7f8bf81a82e0>
[[[-3.18122992e-03  5.75389399e-05 -6.94437506e-04 ... -5.61204496e-06
   -4.52495385e-06  4.29860375e-06]
  [ 1.03579920e-03 -3.69152494e-05  1.71556070e-03 ...  1.53350924e-06
    7.32016358e-06 -1.82418721e-06]
  [ 3.56463428e-03 -6.81153433e-04 -3.69961103e-04 ... -1.07359235e-06
   -4.08662584e-07  7.62245264e-07]]

 [[-3.17290162e-03  7.05497519e-05 -6.84539934e-04 ... -5.68976926e-06
   -4.60249933e-06  4.28077584e-06]
  [ 1.06015057e-03 -2.41688267e-05  1.73520161e-03 ...  1.53144452e-06
    7.33168460e-06 -1.80658265e-06]
  [ 3.40373431e-03 -6.92950222e-04 -3.63984401e-04 ... -1.15865867e-06
   -3.98927225e-07  7.46869782e-07]]

 [[-3.13754121e-03  9.02689553e-05 -6.98012524e-04 ... -5.66385769e-06
   -4.59152101e-06  4.27209294e-06]
  [ 9.86244941e-04 -1.60632199e-05  1.71359216e-03 ...  1.57265591e-06
    7.30901511e-06 -1.80293323e-06]
  [ 3.36276405e-03 -6.84468522e-04 -4.02482450e-04 ... -1.06198407e-06
   -4.02320583e-07  7.19701462e-07]]

 ...

 [[ 8.77462409e-04 -3.03646846e-04 -2.58549941e-04 ...  8.23610315e-07
    1.69644946e-06 -2.26511249e-06]
  [-1.14168525e-03 -6.99611698e-04 -8.20191788e-04 ...  6.52955041e-07
    9.95519358e-08 -2.59752283e-06]
  [-8.05527179e-04  5.91161514e-04  9.32771538e-04 ... -9.62589066e-07
    1.67886543e-06 -6.97731463e-07]]

 [[ 8.77526396e-04 -3.03291450e-04 -2.58605360e-04 ...  1.83454924e-06
    1.58206428e-06  1.76601330e-07]
  [-1.14181762e-03 -6.99784984e-04 -8.20350631e-04 ...  2.46599658e-06
   -1.57049843e-07  1.31387355e-06]
  [-8.05299144e-04  5.91547873e-04  9.31807139e-04 ...  4.46716463e-06
    1.81095414e-06  6.51079120e-07]]

 [[ 8.77666007e-04 -3.02930788e-04 -2.58652640e-04 ...  1.85960035e-06
    1.59892935e-06  3.00959879e-07]
  [-1.14193961e-03 -6.99974074e-04 -8.20524698e-04 ...  2.50268074e-06
   -1.47929922e-07  1.41287140e-06]
  [-8.04995303e-04  5.91719888e-04  9.31217203e-04 ...  4.32085040e-06
    2.02212177e-06  5.91225060e-07]]], 'bs_type': 'lrotmin'}
Traceback (most recent call last):
  File "/home/sakaya/TFG_RelatedWork/CodeTalker/main/train_pred.py", line 249, in <module>
    main()
  File "/home/sakaya/TFG_RelatedWork/CodeTalker/main/train_pred.py", line 50, in main
    main_worker(args.train_gpu, args.ngpus_per_node, args)
  File "/home/sakaya/TFG_RelatedWork/CodeTalker/main/train_pred.py", line 104, in main_worker
    dataset = get_dataloaders(cfg)
  File "/home/sakaya/TFG_RelatedWork/CodeTalker/dataset/data_loader.py", line 112, in get_dataloaders
    train_data, valid_data, test_data, subjects_dict = read_data(args)
  File "/home/sakaya/TFG_RelatedWork/CodeTalker/dataset/data_loader.py", line 73, in read_data
    data[key]["template"] = temp.reshape((-1)) 
AttributeError: 'dict' object has no attribute 'reshape'
